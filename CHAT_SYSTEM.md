# Cybersich Chat System (–ü–∏—Å–∞—Ä—å / Clerk Agent)

–ú—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —á–∞—Ç—É –Ω–∞ –±–∞–∑—ñ LangGraph –¥–ª—è –ø—Ä–æ—î–∫—Ç—É Cybersich.

## üéØ –ö–æ–Ω—Ü–µ–ø—Ü—ñ—è

–°–∏—Å—Ç–µ–º–∞ –ø–æ–±—É–¥–æ–≤–∞–Ω–∞ –Ω–∞–≤–∫–æ–ª–æ —Ç—Ä—å–æ—Ö –∞–≥–µ–Ω—Ç—ñ–≤, —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å –∫–æ–∑–∞—Ü—å–∫—É —ñ—î—Ä–∞—Ä—Ö—ñ—é:

1. **–ü–∏—Å–∞—Ä—å (Clerk)** ‚Äî –•—Ä–æ–Ω—ñ—Å—Ç –±–µ–∑ —Ä–æ–∑–¥—É–º—ñ–≤, –∑–∞–ø–∏—Å—É—î –≤—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ –≥—Ä–∞—Ñ
2. **–ü—ñ–¥—Å–≤—ñ–¥–æ–º—ñ—Å—Ç—å (Subconscious)** ‚Äî –ê–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä –∑–≤'—è–∑–∫—ñ–≤ —Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É *(–º–∞–π–±—É—Ç–Ω—î)*
3. **–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä (Orchestrator)** ‚Äî –ü—Ä–∏–π–º–∞—î —Ä—ñ—à–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É *(–º–∞–π–±—É—Ç–Ω—î)*

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      Frontend (Chat UI)                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ HTTP
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    FastAPI Backend                          ‚îÇ
‚îÇ  /api/chat/session    /api/chat/message   /api/chat/history ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   LangGraph Workflow                        ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ   Entry ‚Üí –ü–∏—Å–∞—Ä—å (Clerk) ‚Üí –ü—ñ–¥—Å–≤—ñ–¥–æ–º—ñ—Å—Ç—å ‚Üí –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä    ‚îÇ
‚îÇ            ‚úÖ MVP             üöß Phase 2      üöß Phase 3   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      FalkorDB Graph                         ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  (:Message)-[:IN_SESSION]->(:ChatSession)                  ‚îÇ
‚îÇ  (:Message)-[:FOLLOWS]->(:Message)                         ‚îÇ
‚îÇ  (:Message)-[:REFERENCES]->(:Message)                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üìä –°—Ö–µ–º–∞ –¥–∞–Ω–∏—Ö –≤ FalkorDB

### –í—É–∑–ª–∏ (Nodes)

#### ChatSession
```cypher
(:ChatSession {
  id: "uuid",
  created_at: datetime,
  user_id: "user_identifier",
  title: "optional_title",
  status: "active|archived",
  metadata: "{}"
})
```

#### Message
```cypher
(:Message {
  id: "uuid",
  content: "—Ç–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è",
  role: "user|assistant|system",
  timestamp: datetime,
  status: "recorded|analyzed|responded",
  metadata: "{}"
})
```

### –ó–≤'—è–∑–∫–∏ (Relationships)

```cypher
// –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–ª–µ–∂–∏—Ç—å –¥–æ —Å–µ—Å—ñ—ó
(:Message)-[:IN_SESSION]->(:ChatSession)

// –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (–º–∞–π–±—É—Ç–Ω—î)
(:Message)-[:FOLLOWS]->(:Message)

// –°–µ–º–∞–Ω—Ç–∏—á–Ω—ñ –∑–≤'—è–∑–∫–∏ (–º–∞–π–±—É—Ç–Ω—î)
(:Message)-[:REFERENCES {similarity: 0.85}]->(:Message)
```

## üöÄ API Endpoints

### 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ —Å–µ—Å—ñ—é
```http
POST /api/chat/session
Content-Type: application/json

{
  "user_id": "user_123",
  "title": "–†–æ–∑–º–æ–≤–∞ –ø—Ä–æ –∫–æ–∑–∞–∫—ñ–≤"
}
```

**Response:**
```json
{
  "session_id": "abc123xyz",
  "created_at": "2025-11-05T12:00:00",
  "user_id": "user_123",
  "title": "–†–æ–∑–º–æ–≤–∞ –ø—Ä–æ –∫–æ–∑–∞–∫—ñ–≤",
  "status": "active"
}
```

### 2. –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
```http
POST /api/chat/message
Content-Type: application/json

{
  "content": "–†–æ–∑–∫–∞–∂–∏ –ø—Ä–æ —ñ—Å—Ç–æ—Ä—ñ—é –∫–æ–∑–∞—Ü—Ç–≤–∞",
  "session_id": "abc123xyz",
  "role": "user"
}
```

**Response:**
```json
{
  "message_id": "msg_abc123",
  "session_id": "abc123xyz",
  "status": "recorded",
  "recorded": true,
  "error": null
}
```

### 3. –û—Ç—Ä–∏–º–∞—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é —Å–µ—Å—ñ—ó
```http
GET /api/chat/session/abc123xyz/history?limit=50&offset=0
```

**Response:**
```json
{
  "session_id": "abc123xyz",
  "messages": [
    {
      "id": "msg_001",
      "content": "–†–æ–∑–∫–∞–∂–∏ –ø—Ä–æ —ñ—Å—Ç–æ—Ä—ñ—é –∫–æ–∑–∞—Ü—Ç–≤–∞",
      "role": "user",
      "timestamp": "2025-11-05T12:00:00",
      "status": "recorded"
    }
  ],
  "total": 1
}
```

### 4. –û—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å–µ—Å—ñ—é
```http
GET /api/chat/session/abc123xyz
```

## üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥—É

```
backend/app/
‚îú‚îÄ‚îÄ agents/                      # –ú—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞ —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ state.py                # ChatState - —Å–ø—ñ–ª—å–Ω–∏–π state
‚îÇ   ‚îú‚îÄ‚îÄ graph.py                # LangGraph workflow
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ clerk/                  # –ü–∏—Å–∞—Ä—å (Phase 1 - MVP)
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ schemas.py          # ChatMessage, ChatSession
‚îÇ       ‚îú‚îÄ‚îÄ repository.py       # FalkorDB CRUD
‚îÇ       ‚îî‚îÄ‚îÄ nodes.py            # clerk_record_node
‚îÇ
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ chat_routes.py          # FastAPI endpoints
‚îÇ
‚îî‚îÄ‚îÄ main.py                      # Integration
```

## üîÑ –Ø–∫ –ø—Ä–∞—Ü—é—î –ü–∏—Å–∞—Ä—å (Clerk - MVP)

### –ü–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö:

1. **Frontend** ‚Üí `POST /api/chat/message` –∑ —Ç–µ–∫—Å—Ç–æ–º
2. **API** ‚Üí –°—Ç–≤–æ—Ä—é—î `ChatState` –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º
3. **LangGraph** ‚Üí –ó–∞–ø—É—Å–∫–∞—î workflow
4. **Clerk Node** ‚Üí –ó–∞–ø–∏—Å—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ FalkorDB
5. **Response** ‚Üí –ü–æ–≤–µ—Ä—Ç–∞—î `message_id` —Ç–∞ —Å—Ç–∞—Ç—É—Å

### –ö–æ–¥ Clerk Node:

```python
async def clerk_record_node(state: dict, repository: MessageRepository) -> dict:
    """–ó–∞–ø–∏—Å—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ FalkorDB –±–µ–∑ –æ–±—Ä–æ–±–∫–∏."""
    
    message = ChatMessage(
        content=state["message_content"],
        role=state["message_role"],
        session_id=state["session_id"],
        status="recorded"
    )
    
    message_id = await repository.create_message(message)
    
    state["message_id"] = message_id
    state["recorded"] = True
    
    return state
```

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–µ—Å—ñ—ó —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:

```bash
# 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ —Å–µ—Å—ñ—é
curl -X POST http://localhost:8000/api/chat/session \
  -H "Content-Type: application/json" \
  -d '{"user_id": "test_user", "title": "Test Chat"}'

# –û—Ç—Ä–∏–º–∞—î–º–æ session_id: "abc123xyz"

# 2. –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
curl -X POST http://localhost:8000/api/chat/message \
  -H "Content-Type: application/json" \
  -d '{
    "content": "–†–æ–∑–∫–∞–∂–∏ –ø—Ä–æ –∫–æ–∑–∞—Ü—å–∫—É —ñ—Å—Ç–æ—Ä—ñ—é",
    "session_id": "abc123xyz",
    "role": "user"
  }'

# 3. –û—Ç—Ä–∏–º–∞—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é
curl http://localhost:8000/api/chat/session/abc123xyz/history
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤ FalkorDB:

```cypher
// –í—Å—ñ —Å–µ—Å—ñ—ó
MATCH (s:ChatSession) RETURN s

// –í—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Å–µ—Å—ñ—ó
MATCH (m:Message)-[:IN_SESSION]->(s:ChatSession {id: "abc123xyz"})
RETURN m.id, m.content, m.role, m.timestamp
ORDER BY m.timestamp ASC

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
MATCH (m:Message) RETURN count(m) as total_messages
MATCH (s:ChatSession) RETURN count(s) as total_sessions
```

## üì¶ –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

```txt
langgraph==0.2.28        # Multi-agent orchestration
langchain-core==0.3.10   # Core primitives for LangGraph
```

## üîÆ –ú–∞–π–±—É—Ç–Ω—ñ —Ñ–∞–∑–∏

### Phase 2: –ü—ñ–¥—Å–≤—ñ–¥–æ–º—ñ—Å—Ç—å (Subconscious Agent)

**–ó–∞–≤–¥–∞–Ω–Ω—è:**
- –ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- –®—É–∫–∞—Ç–∏ —Å–µ–º–∞–Ω—Ç–∏—á–Ω—ñ –∑–≤'—è–∑–∫–∏ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏
- –§–æ—Ä–º—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó:**
- Embedding models (OpenAI, local BERT)
- Vector similarity –≤ FalkorDB
- Cypher graph traversal

### Phase 3: –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä (Orchestrator Agent)

**–ó–∞–≤–¥–∞–Ω–Ω—è:**
- –ü—Ä–∏–π–º–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è –¥–æ —Ä—ñ–∑–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ (Gemini, RAG, tools)
- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π

**–ú–æ–∂–ª–∏–≤—ñ –¥—ñ—ó:**
- `respond` ‚Äî –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —á–µ—Ä–µ–∑ Gemini
- `ask_clarification` ‚Äî –ü–æ–ø—Ä–æ—Å–∏—Ç–∏ —É—Ç–æ—á–Ω–µ–Ω–Ω—è
- `search` ‚Äî –ü–æ—à—É–∫ –≤ knowledge base
- `use_tool` ‚Äî –í–∏–∫–ª–∏–∫ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É

### Phase 4: Advanced Features

- **WebSocket** –¥–ª—è real-time streaming
- **Context window management** ‚Äî –¥–∏–Ω–∞–º—ñ—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- **Multi-turn reasoning** ‚Äî —Å–∫–ª–∞–¥–Ω—ñ –ª–∞–Ω—Ü—é–≥–∏ –º—ñ—Ä–∫—É–≤–∞–Ω—å
- **Tool calling** ‚Äî —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ API

## üé® –ö—É–ª—å—Ç—É—Ä–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

–ù–∞–∑–≤–∏ –∞–≥–µ–Ω—Ç—ñ–≤ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å –∫–æ–∑–∞—Ü—å–∫—É –∫—É–ª—å—Ç—É—Ä—É:

- **–ü–∏—Å–∞—Ä—å** ‚Äî –ö–æ–∑–∞—Ü—å–∫–∏–π –ø–∏—Å–∞—Ä, —â–æ –≤—ñ–≤ —Ä–µ—î—Å—Ç—Ä–∏ —Ç–∞ —Ö—Ä–æ–Ω—ñ–∫–∏
- **–ü—ñ–¥—Å–≤—ñ–¥–æ–º—ñ—Å—Ç—å** ‚Äî –ö–æ–ª–µ–∫—Ç–∏–≤–Ω–∞ –ø–∞–º'—è—Ç—å –Ω–∞—Ä–æ–¥—É, –∑–≤'—è–∑–∫–∏ –º—ñ–∂ –ø–æ–¥—ñ—è–º–∏
- **–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä** ‚Äî –û—Ç–∞–º–∞–Ω, —â–æ –ø—Ä–∏–π–º–∞—î —Å—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è

## ‚ö° –ü–µ—Ä–µ–≤–∞–≥–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

1. **–ë–µ–∑–∫—ñ–Ω–µ—á–Ω–∞ –ø–∞–º'—è—Ç—å** ‚Äî –í—Å—è —ñ—Å—Ç–æ—Ä—ñ—è –≤ –≥—Ä–∞—Ñ—ñ, –±–µ–∑ –æ–±–º–µ–∂–µ–Ω—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞
2. **–°–µ–º–∞–Ω—Ç–∏—á–Ω–∏–π –ø–æ—à—É–∫** ‚Äî –ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É —á–µ—Ä–µ–∑ –≥—Ä–∞—Ñ
3. **–ú–æ–¥—É–ª—å–Ω—ñ—Å—Ç—å** ‚Äî –ö–æ–∂–µ–Ω –∞–≥–µ–Ω—Ç –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–π, –ª–µ–≥–∫–æ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏
4. **–†–æ–∑—à–∏—Ä—é–≤–∞–Ω—ñ—Å—Ç—å** ‚Äî –î–æ–¥–∞—Ç–∏ –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ = –¥–æ–¥–∞—Ç–∏ node –≤ –≥—Ä–∞—Ñ
5. **–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è** ‚Äî LangGraph –¥–æ–∑–≤–æ–ª—è—î –≤—ñ–∑—É–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ—Ç—ñ–∫
6. **Async-first** ‚Äî –ü–æ–≤–Ω—ñ—Å—Ç—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π, —à–≤–∏–¥–∫–∏–π

## üìù –õ–æ–≥–∏

–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥—É—î –≤—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó:

```
üìù –ü–∏—Å–∞—Ä—å: –ü–æ—á–∏–Ω–∞—é –∑–∞–ø–∏—Å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...
üìù –ü–∏—Å–∞—Ä—å —É—Å–ø—ñ—à–Ω–æ –∑–∞–ø–∏—Å–∞–≤: msg_abc123 (role=user, content_length=156)
‚úÖ Chat workflow compiled successfully
ü§ñ Multi-agent chat system (–ü–∏—Å–∞—Ä—å) initialized
```

## üêõ Troubleshooting

### –ü–æ–º–∏–ª–∫–∞: "Chat workflow not initialized"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ FalkorDB –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π —ñ workflow —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –≤ `lifespan`

### –ü–æ–º–∏–ª–∫–∞: "Session not found"
**–†—ñ—à–µ–Ω–Ω—è:** –°–ø–æ—á–∞—Ç–∫—É —Å—Ç–≤–æ—Ä—ñ—Ç—å —Å–µ—Å—ñ—é —á–µ—Ä–µ–∑ `POST /api/chat/session`

### –ü–æ–º–∏–ª–∫–∞: "Message creation failed"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ —ñ—Å–Ω—É—î —Å–µ—Å—ñ—è –∑ –≤–∫–∞–∑–∞–Ω–∏–º `session_id`

## üìö –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [LangGraph Documentation](https://langchain-ai.github.io/langgraph/)
- [FalkorDB Cypher Guide](https://docs.falkordb.com/)
- [FalkorDB Integration Rules](.cursor/rules/falkordb.mdc)
- [Architecture Principles](.cursor/rules/architecture.mdc)

